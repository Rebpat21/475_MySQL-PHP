ALTER TABLE EMPLOYEE_Lab2 DROP FOREIGN KEY EMPLOYEE_Lab2_CODE;
ALTER TABLE STORE_Lab2 DROP FOREIGN KEY STORE_Lab2_CODE;

DROP TABLE IF EXISTS EMPLOYEE_Lab2, REGION_Lab2, STORE_Lab2;

CREATE TABLE EMPLOYEE_Lab2 (
EMP_CODE int NOT NULL PRIMARY KEY,
EMP_TITLE varchar(4),
EMP_LNAME varchar(15),
EMP_FNAME varchar(15),
EMP_INITIAL varchar(1),
EMP_DOB datetime,
STORE_CODE int
);

CREATE TABLE REGION_Lab2 (
REGION_CODE int NOT NULL PRIMARY KEY,
REGION_DESCRIPT varchar(10)
);

CREATE TABLE STORE_Lab2 (
STORE_CODE int NOT NULL PRIMARY KEY,
STORE_NAME varchar(20),
STORE_YTD_SALES numeric,
REGION_CODE int,
EMP_CODE int
);

ALTER TABLE EMPLOYEE_Lab2 ADD CONSTRAINT EMPLOYEE_Lab2_CODE FOREIGN KEY EMPLOYEE_Lab2_CODE(STORE_CODE) REFERENCES STORE_Lab2(STORE_CODE);
ALTER TABLE STORE_Lab2 ADD CONSTRAINT STORE_Lab2_CODE FOREIGN KEY STORE_Lab2_CODE(REGION_CODE) REFERENCES REGION_Lab2(REGION_CODE);

INSERT INTO REGION_Lab2 VALUES('1','East');
INSERT INTO REGION_Lab2 VALUES('2','West');

INSERT INTO STORE_Lab2 VALUES('1','Access Junction','1003455.76','2','8');
INSERT INTO STORE_Lab2 VALUES('2','Database Corner','1421987.39','2','12');
INSERT INTO STORE_Lab2 VALUES('3','Tuple Charge','986783.22','1','7');
INSERT INTO STORE_Lab2 VALUES('4','Attribute Alley','944568.56','2','3');
INSERT INTO STORE_Lab2 VALUES('5','Primary Key Point','2930098.45','1','15');

INSERT INTO EMPLOYEE_Lab2 VALUES('1','Mr.','Williamson','John','W','1964-5-21','3');
INSERT INTO EMPLOYEE_Lab2 VALUES('2','Ms.','Ratula','Nancy','','1969-2-9','2');
INSERT INTO EMPLOYEE_Lab2 VALUES('3','Ms.','Greenboro','Lottie','R','1961-10-2','4');
INSERT INTO EMPLOYEE_Lab2 VALUES('4','Mrs.','Rumpersfro','Jennie','S','1971-6-1','5');
INSERT INTO EMPLOYEE_Lab2 VALUES('5','Mr.','Smith','Robert','L','1959-11-23','3');
INSERT INTO EMPLOYEE_Lab2 VALUES('6','Mr.','Renselaer','Cary','A','1965-12-25','1');
INSERT INTO EMPLOYEE_Lab2 VALUES('7','Mr.','Ogallo','Roberto','S','1962-7-31','3');
INSERT INTO EMPLOYEE_Lab2 VALUES('8','Ms.','Johnsson','Elizabeth','I','1968-9-10','1');
INSERT INTO EMPLOYEE_Lab2 VALUES('9','Mr.','Eindsmar','Jack','W','1955-4-19','2');
INSERT INTO EMPLOYEE_Lab2 VALUES('10','Mrs.','Jones','Rose','R','1966-3-6','4');
INSERT INTO EMPLOYEE_Lab2 VALUES('11','Mr.','Broderick','Tom','','1972-10-21','3');
INSERT INTO EMPLOYEE_Lab2 VALUES('12','Mr.','Washington','Alan','Y','1974-9-8','2');
INSERT INTO EMPLOYEE_Lab2 VALUES('13','Mr.','Smith','Peter','N','1964-8-25','3');
INSERT INTO EMPLOYEE_Lab2 VALUES('14','Ms.','Smith','Sherry','H','1966-5-25','4');
INSERT INTO EMPLOYEE_Lab2 VALUES('15','Mr.','Olenko','Howard','U','1964-5-24','5');
INSERT INTO EMPLOYEE_Lab2 VALUES('16','Mr.','Archialo','Barry','V','1960-9-3','5');
INSERT INTO EMPLOYEE_Lab2 VALUES('17','Ms.','Grimaldo','Jeanine','K','1970-11-12','4');
INSERT INTO EMPLOYEE_Lab2 VALUES('18','Mr.','Rosenberg','Andrew','D','1971-1-24','4');
INSERT INTO EMPLOYEE_Lab2 VALUES('19','Mr.','Rosten','Peter','F','1968-10-3','4');
INSERT INTO EMPLOYEE_Lab2 VALUES('20','Mr.','Mckee','Robert','S','1970-3-6','1');
INSERT INTO EMPLOYEE_Lab2 VALUES('21','Ms.','Baumann','Jennifer','A','1974-12-11','3');

select STORE_NAME from STORE_Lab2 natural join REGION_Lab2 where REGION_DESCRIPT='East';
select STORE_NAME from STORE_Lab2 natural join REGION_Lab2 where REGION_DESCRIPT='West';
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE where STORE_Lab2.STORE_CODE=1;
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE where STORE_Lab2.STORE_CODE=2;
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE where STORE_Lab2.STORE_CODE=3;
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE where STORE_Lab2.STORE_CODE=4;
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE where STORE_Lab2.STORE_CODE=5;
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE natural join REGION_Lab2 where REGION_DESCRIPT='East';
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE natural join REGION_Lab2 where REGION_DESCRIPT='West';
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE natural join REGION_Lab2 where REGION_DESCRIPT='East' AND EMP_DOB<'1973-01-01';
select EMP_LNAME from EMPLOYEE_Lab2 left outer join STORE_Lab2 on EMPLOYEE_Lab2.STORE_CODE=STORE_Lab2.STORE_CODE natural join REGION_Lab2 where REGION_DESCRIPT='West' AND EMP_DOB>'1968-01-01';
